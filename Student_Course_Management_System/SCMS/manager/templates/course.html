{% extends "base.html" %}

{% block title%}SCMS - Course{% endblock%}

{% block content %}  
    
     <h1>Courses</h1>

{% comment %} Search + Add Button {% endcomment %}
     <div>
          <form method="get" action="{% url 'course_list' %}">
               <input type="text" name="search">
               <button>Search</button>
          </form>
     </div>
     <div>
          <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addCourseModal">
               Add Course
          </button>
     </div>

{% comment %} Course Table {% endcomment %}

     <table class="table table-bordered">          
          <tr>
               <th>Name</th>
               <th>Duration</th>
               <th>Fee</th>
               <th>Actions</th>
          </tr>

          {% for course in courses %}
               <tr>
                    <td>{{ course.course_name }}</td>
                    <td>{{ course.duration }}</td>
                    <td>{{ course.fee }}</td>
                    <td>
                         <button class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#editModal{{ course.id }}">Edit</button>
                         <button class="btn btn-danger btn-sm" data-bs-toggle="modal" data-bs-target="#deleteModal{{ course.id }}">Delete</button>
                    </td>
               </tr>
          {% endfor %}
     </table>

{% comment %} Add course modal {% endcomment %}

     <div class="modal fade" id="addCourseModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
          <div class="modal-dialog">
               <form method="post" action="{% url 'add_course' %}">
                    {% csrf_token %}
                    <div class="modal-content">
                         <div class="modal-header">
                              <h5 class="modal-title">Add Course</h5>
                              <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                         </div>
                         <div class="modal-body">
                              {{ form.as_p }}
                         </div>
                         <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                              <button type="submit" class="btn btn-success">Save</button>
                         </div>
                    </div>
               </form>
          </div>
     </div>

{% comment %} Edit Course Modal (Inside Loop) {% endcomment %}

     {% for course in courses %}
          <div class="modal fade" id="editModal{{ course.id }}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
               <div class="modal-dialog">
                    <form method="post" action="{% url 'edit_course' course.id %}" class="form-control">
                         {% csrf_token %}
                         <div class="modal-content">
                              <div class="modal-header">
                                   <h5>Edit Course</h5>
                                   <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                              </div>
                              <div class="modal-body">
                                   <label>Course Name</label> {{ course.form.course_name }}
                                   <label>Duration</label> {{ course.form.duration }}
                                   <label>Fee</label>{{ course.form.fee }}
                              </div>
                              <div class="modal-footer">
                                   <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                   <button type="submit" class="btn btn-success">Update</button>
                              </div>
                         </div>
                    </form>
               </div>
          </div>
     {% endfor %}

 {% comment %} Delete Course Modal {% endcomment %}

     {% for course in courses %}
          <div class="modal fade" id="deleteModal{{ course.id }}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
               <div class="modal-dialog">
                    <form method="post" action="{% url 'delete_course' course.id %}">
                         {% csrf_token %}
                         <div class="modal-content">
                              <div class="modal-header">
                                   <h5>Delete Course</h5>
                                   <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                              </div>
                              <div class="modal-body">
                                   Are you sure you want to delete <b>{{ course.course_name }}</b>?
                              </div>
                              <div class="modal-footer">
                                   <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                   <button class="btn btn-danger">Delete</button>
                              </div>
                         </div>
                    </form>
               </div>
          </div>
     {% endfor %}
   
{% endblock %}